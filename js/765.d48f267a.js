"use strict";(self["webpackChunk_radiantearth_stac_browser"]=self["webpackChunk_radiantearth_stac_browser"]||[]).push([[765,6228],{6584:function(t,e,i){i.r(e),i.d(e,{default:function(){return f}});var s=function(){var t=this,e=t._self._c;return e("main",{staticClass:"search d-flex flex-column"},[t.parent?t.searchLink?e("b-row",[e("b-col",{staticClass:"left"},[e("ItemFilter",t._b({attrs:{stac:t.parent,title:"",value:t.filters},on:{input:t.setFilters}},"ItemFilter",t.filterComponentProps,!1))],1),e("b-col",{staticClass:"right"},[t.loading?e("Loading",{attrs:{fill:"",top:""}}):t.hasItems||t.hasFilters?t.hasItems?t._e():e("b-alert",{attrs:{variant:"warning",show:""}},[t._v(t._s(t.$t("search.noItemsFound")))]):e("b-alert",{attrs:{variant:"info",show:""}},[t._v(t._s(t.$t("search.modifyCriteria")))]),t.hasItems?[e("div",{attrs:{id:"search-map"}},[e("Map",{attrs:{stac:t.parent,stacLayerData:t.itemCollection,scrollWheelZoom:"",popover:""}})],1),e("Items",{attrs:{stac:t.parent,items:t.apiItems,api:!0,allowFilter:!1,pagination:t.itemPages},on:{paginate:t.paginateItems}})]:t._e()],2)],1):e("b-alert",{attrs:{variant:"danger",show:""}},[t._v(t._s(t.$t("search.notSupported")))]):e("Loading",{attrs:{stretch:""}})],1)},a=[],r=i(1540),n=i(629),o=i(9879),l=i(9189),h=i(3876),c=i(9091),p=i(3989);const m="__search__";var g={name:"Search",components:{ItemFilter:h["default"],Items:r.Z,Loading:c.Z,Map:()=>i.e(8746).then(i.bind(i,8746))},mixins:[(0,l.ZP)(!1)],props:{loadParent:{type:String,default:null}},data(){return{parent:null,filters:{},selectedItem:null}},computed:{...(0,n.rn)(["apiItems","apiItemsLink","apiItemsPagination","catalogUrl","catalogTitle"]),...(0,n.Se)(["getStac","root","collectionLink","parentLink","fromBrowserPath","getApiItemsLoading"]),pageTitle(){return this.$t("search.title")},loading(){return this.getApiItemsLoading(m)},searchLink(){return this.parent instanceof p.Z&&this.parent.getSearchLink()},itemCollection(){return{type:"FeatureCollection",features:this.apiItems,links:[]}},itemPages(){let t=Object.assign({},this.apiItemsPagination);return!t.first&&this.data&&this.apiItemsLink&&(t.first=o.ZP.addFiltersToLink(this.apiItemsLink,this.filters)),t},hasFilters(){return o.ZP.size(this.filters)>0},hasItems(){return this.apiItems.length>0},pageDescription(){let t=p.Z.getDisplayTitle([this.collectionLink,this.parentLink,this.root],this.catalogTitle);return this.$t("search.metaDescription",{title:t})}},watch:{searchLink:{immediate:!0,handler(){this.searchLink&&this.showPage()}}},async created(){let t=this.catalogUrl;this.loadParent?(t=this.fromBrowserPath(this.loadParent),this.parent=this.getStac(t)):this.parent=this.root,this.parent||(await this.$store.dispatch("load",{url:t}),this.root||this.$store.commit("config",{catalogUrl:t}),this.parent=this.getStac(t))},methods:{...(0,n.OI)(["toggleApiItemsLoading"]),async setFilters(t,e=!1){this.filters=t,e?this.$store.commit("resetApiItems"):await this.filterItems(t)},showPage(){this.$store.commit("showPage",{title:this.pageTitle,description:this.pageDescription}),this.$store.commit("setApiItemsLink",this.searchLink)},async paginateItems(t){this.toggleApiItemsLoading(m);try{let e=await this.$store.dispatch("loadApiItems",{link:t,show:!0,filters:this.filters});this.handleResponse(e)}catch(e){this.$root.$emit("error",e,this.$t("errors.loadItems"))}finally{this.toggleApiItemsLoading(m)}},async filterItems(t){this.toggleApiItemsLoading(m);try{let e=await this.$store.dispatch("loadApiItems",{link:this.searchLink,show:!0,filters:t});this.handleResponse(e)}catch(e){this.$root.$emit("error",e,this.$t("errors.loadFilteredItems"))}finally{this.toggleApiItemsLoading(m)}},handleResponse(t){t&&this.$store.commit("showPage",{title:this.pageTitle,url:t.config.url,description:this.pageDescription})}}},d=g,I=i(1001),u=(0,I.Z)(d,s,a,!1,null,"337e5e80",null),f=u.exports}}]);
//# sourceMappingURL=765.d48f267a.js.map